@model Web.ViewModels.CompanyViewModel

@{
    var tableId = Guid.NewGuid();

    var detailsUrl = Url.RouteUrl("DetailsCompany");
    var groupedData = (IEnumerable<IGrouping<string, CompanyDataViewModel>>)ViewData["GroupedData"];
}

<div class="ui card">
    <div class="content">
        <div class="header">@Model.Name</div>
        <table class="ui celled table">
            <tbody>
                <tr>
                    <td><label asp-for="EIN"></label></td>
                    <td>@Model.EIN</td>
                </tr>
                <tr>
                    <td><label asp-for="DB"></label></td>
                    <td>@Model.DB</td>
                </tr>
                <tr>
                    <td><label asp-for="Founded"></label></td>
                    <td>@Model.Founded</td>
                </tr>
            </tbody>
        </table>

        <a class="ui right floated mini icon button" asp-route="AddCompanyData" asp-route-id="@Model.Id" asp-route-full="0" data-request="ajax" rel="dialog" data-title="Add company data">
            <i class="plus icon"></i>
        </a>
        <h4 class="ui dividing header">Company Data</h4>

        <table id="@(tableId)_data" class="ui celled table">
            <tbody>
                @foreach(var group in groupedData) {
                    var groupId = Guid.NewGuid();

                    <tr data-label="@groupId">
                        <td data-label="Name">@group.Key</td>
                        <td data-label="Data">
                            <table>
                                @foreach(var data in group) {
                                    <tr id="@(data.Id)_filed">
                                        <td style="border: none; padding: 0px 10px 0px 10px;">
                                            <span class="text-overflow">@data.Value</span>
                                        </td>
                                        <td style="vertical-align: baseline; border: none; padding: 0 10px 0 10px;">
                                            <a asp-route="DeleteCompanyData" asp-route-id="@data.Id" data-request="ajax" data-root="@groupId" data-target="#@(data.Id)_filed" rel="onDeleteCompanyDataClick" onclick="return confirm('Are you sure want to delete this?')">delete</a>
                                        </td>
                                    </tr>
                                }
                            </table>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
    <div class="extra content">
        <a asp-route="DetailsCompany" asp-route-id="@Model.Id" asp-route-full="0" data-request="ajax" rel="dialog" data-title="Company data details">
            <i class="search icon"></i>
        </a>
    </div>
</div>