@{
    ViewData["Title"] = "Vendors";

    var tableId = Guid.NewGuid();

    var listUrl = Url.RouteUrl("GetVendors");
    var deleteUrl = Url.RouteUrl("DeleteVendors");
    var detailsUrl = Url.RouteUrl("DetailsVendor");
    var editUrl = Url.RouteUrl("EditVendor");
    var displayUrl = Url.Action("Details");
}

@section RightSidebar {
    <div id="@(tableId)_details"></div>
}

<div id="toolbar" class="flex justify-content-between">
    <a asp-route="AddVendor" class="ui button" data-request="ajax" rel="dialog" data-title="Create vendor"><i class="fa fa-plus mr-1"></i> Create</a>
    <button class="red ui button" data-action="delete" disabled><i class="trash icon"></i> Delete</button>
</div>

<table id="@(tableId)" class="ui selectable celled unstackable orange table" data-toolbar="#toolbar"></table>

@section Scripts {
    <script type="text/javascript">
    $(document).ready(function () {
        window.DocumentController = new DocumentController({
            'table': '#@tableId',
            'controller': {
                'list': '@listUrl',
                'delete': '@deleteUrl'
            },
            'columns': [
                { 'title': '', 'data': 'id', 'className': 'collapsing', 'render': (data, type, row) => $.fn.renderDatatableAction(data, type, row) },
                { 'title': 'Business Name', 'data': 'name' },
                { 'title': 'Modified', 'className': 'collapsing', 'data': 'updatedDate', 'render': (data, type, row) => $.fn.formatDate(data, type, row) },
                {
                  'title': 'Action', 'data': 'id', 'className': 'collapsing', 'render': (data, type, row) => {
                    return `<a class='ui icon' data-request='ajax' href='@(editUrl)?id=${data}' rel='dialog' data-title='Edit'>
                              <i class="pencil icon"></i>
                            </a>`;
                    }
                }
            ],
            'onRowClick': (e, data) => {
                if (e.target.tagName === 'TD') {
                    $.get('@detailsUrl', { 'id': data.id }).done(result => {
                        $('#@(tableId)_details').html(result);
                    });
                }
            },
        });
    });

    ajaxSubmitComplete = function (e, jqXHR, status) {
        if (status === 'success') {
            window.DocumentController.reload(false);
            window.dialog.modal('hide');
        }
    };

    ajaxClick = function (e, jqXHR, status) {
        if (status === 'success') {
            var target = $(e.target).attr('data-target');
            $(target).remove();
        }
    };
    </script>
}