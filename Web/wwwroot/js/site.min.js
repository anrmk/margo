$.fn.disabled=function(){$(this).attr("disabled","disabled")};$.fn.enabled=function(){$(this).removeAttr("disabled")};class DocumentController{constructor(n,t=()=>{}){this.options=$.extend(!0,{table:"#table",filter:"#table-filter",controller:{list:"","delete":""},columns:[],selected:[],onRowClick:()=>{},onDblRowClick:()=>{}},n);this.table=$(this.options.table);this.toolbar=$(this.table.data("toolbar"));this.filter=$(this.options.filter);this.datatable=this.table.DataTable({ajax:{url:this.options.controller.list,data:n=>$.extend({},n,this.filter.serializeJSON())},columns:this.options.columns,rowCallback:(n,t)=>{$.inArray(t.id,this.options.selected)!==-1&&$(n).find("input[type=checkbox]").attr("checked",!0)}});this.initialize();this.callback=t}initialize(){var n=this.table.find("tbody");this.toolbar.find("button[data-action=delete]").on("click",n=>this.remove(n));n.on("click","tr",n=>{var t=$(n.currentTarget),i=this.datatable.row(t);t.hasClass("active")?t.removeClass("active"):(this.table.find("tr.active").removeClass("active"),t.addClass("active"));this.options.onRowClick(n,i.data())});n.on("dblclick","tr",n=>{var t=this.datatable.row(n.currentTarget);this.options.onDblRowClick(n,t.data())});n.on("change","input",n=>{var r=$(n.currentTarget),t=Number(r.val()),i=$.inArray(t,this.options.selected);i===-1?this.options.selected.push(t):this.options.selected.splice(i,1);this.options.selected.length>0?this.toolbar.find("button[data-action=delete]").enabled():this.toolbar.find("button[data-action=delete]").disabled()})}remove(){if(!confirm("Are you sure want to delete this?"))return!1;var n={url:this.options.controller.delete,data:{id:this.options.selected},traditional:!0,contentType:"application/json; charset=utf-8",complete:(n,t)=>{if(t==="success"){var i=this.options.selected.map(n=>"#row_"+n);this.datatable.rows(i).remove().draw(!1);this.options.selected=[]}}};$.ajax(n)}}$.fn.ajaxSubmit=function(n){this.on("submit",t=>{t.preventDefault();var i=$(t.currentTarget),u=i.serializeJSON(),r=$.extend({url:i.attr("action"),type:i.attr("method"),data:JSON.stringify(i.serializeJSON()),processData:!1,contentType:"application/json; charset=utf-8",complete:(t,r)=>{i.removeClass("loading"),n.callback(t,r)},callback:()=>{}},n);i.addClass("loading");$.ajax(r)})};$.fn.formatCurrency=function(n){return"$"+n.toFixed(2).replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")};$.fn.formatLink=function(n){return n==null?"":`<a href='${n}'target="_blank"><i class="fa fa-external-link-alt mr-1"></i>${n}</a>`};$.fn.formatDate=function(n){return n==null?"":new Date(n).toLocaleDateString()};$.fn.renderDatatableAction=function(n){return`<div class='ui fitted slider checkbox'><input type='checkbox' name='Id[]' value='${n}'> <label></label></div>`};$.fn.dialog=function(n){var i=$(this==null||this.length==0?"<p>Nothing to display<\/p>":this),t=$.extend({},{title:"Modal window",content:i},n),r=`<div class="ui modal"><i class="close icon"></i><div class="header">${t.title}</div>`+`<div class="content">${t.content.html()}</div>`+`<div class="actions"><div class="ui button deny">Cancel</div><button class="ui button green submit">OK</button></div>`+`</div>`;$(r).modal({closable:!1,transition:"horizontal flip",onVisible:function(){var t=$(this),n=t.find("form");n.length&&(n.ajaxSubmit({callback:(n,t)=>{$(".modal").modal("hide"),$.fn.message({content:n.responseText,status:t})}}),t.find("button.submit").attr("form",n.attr("id")))}}).modal("show")};$.fn.message=function(n){var t=$.extend({},{title:"",content:"",status:"info"},n),i=`<div class='ui floating ${t.status} message'><i class='close icon'></i> <div class='header'>${t.title}</div><p>${t.content}</p></div>`;$(i).appendTo("body").delay(1500).remove()};$(document).ready(()=>{$(".masthead").visibility({once:!1,onBottomPassed:function(){$(".fixed.menu").transition("fade in")},onBottomPassedReverse:function(){$(".fixed.menu").transition("fade out")}}),$("form[data-submit=ajax]").ajaxSubmit({callback:function(n,t){t==="success"&&$(`<div>${n.responseText}</div>`).dialog()}})}).ajaxSend(()=>{}).ajaxStart(()=>{$("form fieldset").attr("disabled","disabled")}).ajaxStop(()=>{$("form fieldset").removeAttr("disabled")}).ajaxError((n,t)=>{window.console.log("Error",t.responseText)});$.extend(!0,$.fn.dataTable.defaults,{toolbar:"#toolbar",dom:`<'ui stackable grid'<'row'<'eight wide column'<'dt-toolbar'>><'right aligned four wide column'l><'right aligned four wide column'f>><'row dt-table'<'sixteen wide column'tr>><'row'<'seven wide column'i><'right aligned nine wide column'p>>>`,searching:!0,ordering:!1,processing:!0,serverSide:!0,searchDelay:1800,autoWidth:!1,mark:!0,rowId:function(n){return"row_"+n.id},language:{search:"_INPUT_",searchPlaceholder:"Search..."},fnInitComplete:function(){$($.fn.dataTable.defaults.toolbar).appendTo($("div.dt-toolbar"))}});$.extend($.serializeJSON.defaultOptions,{parseNumbers:!0,useIntKeysAsArrayIndex:!1,customTypes:{"string:nullable":function(n){return n||null},"number:nullable":function(n){return Number(n)||null}}});